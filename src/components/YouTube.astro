---
interface Props {
  id: string;
  title: string;
}

const { id, title } = Astro.props;
const thumbnailUrl = `https://i.ytimg.com/vi/${id}/hqdefault.jpg`;
---

<div class="youtube-facade" data-video-id={id}>
  <img src={thumbnailUrl} alt={title} loading="lazy" />
  <button class="play-button" aria-label={`Play: ${title}`}>
    <svg viewBox="0 0 68 48" width="68" height="48">
      <path d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z" fill="#f00"/>
      <path d="M 45,24 27,14 27,34" fill="#fff"/>
    </svg>
  </button>
  <span class="video-title">{title}</span>
</div>

<script>
  document.querySelectorAll('.youtube-facade').forEach(facade => {
    facade.addEventListener('click', function() {
      const videoId = this.dataset.videoId;
      const iframe = document.createElement('iframe');
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
      iframe.setAttribute('frameborder', '0');
      iframe.setAttribute('allowfullscreen', '');
      iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
      this.innerHTML = '';
      this.appendChild(iframe);
      this.classList.add('activated');
    });
  });
</script>

<style>
  .youtube-facade {
    position: relative;
    aspect-ratio: 16 / 9;
    background: var(--bg-card);
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
  }

  .youtube-facade img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .youtube-facade:hover img {
    transform: scale(1.05);
  }

  .play-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: none;
    border: none;
    cursor: pointer;
    opacity: 0.9;
    transition: opacity 0.2s, transform 0.2s;
  }

  .youtube-facade:hover .play-button {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.1);
  }

  .video-title {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 1rem;
    background: linear-gradient(transparent, rgba(0,0,0,0.8));
    color: white;
    font-size: 0.9rem;
    font-weight: 500;
  }

  .youtube-facade.activated {
    cursor: default;
  }

  .youtube-facade.activated iframe {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }
</style>
