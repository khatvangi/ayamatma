---
// zen image carousel - auto-rotating gallery
const images = [
  { src: '/images/carousel/monk-meditation-1.png', alt: 'Monk in meditation' },
  { src: '/images/carousel/zen-mountains.png', alt: 'Zen mountains' },
  { src: '/images/carousel/tree-meditation.png', alt: 'Tree meditation' },
  { src: '/images/carousel/japanese-style.png', alt: 'Japanese style art' },
  { src: '/images/carousel/flowing-lines.png', alt: 'Flowing lines' },
  { src: '/images/carousel/zen-art-1.png', alt: 'Zen art' },
  { src: '/images/carousel/meditation-zen.png', alt: 'Meditation' },
  { src: '/images/carousel/monk-meditation-2.png', alt: 'Monk meditation' },
];
---

<div class="carousel" id="carousel">
  <div class="carousel-track" id="carousel-track">
    {images.map((img, i) => (
      <div class={`carousel-slide ${i === 0 ? 'active' : ''}`} data-index={i}>
        <img src={img.src} alt={img.alt} loading="lazy" />
      </div>
    ))}
  </div>
  <div class="carousel-dots" id="carousel-dots">
    {images.map((_, i) => (
      <button
        class={`carousel-dot ${i === 0 ? 'active' : ''}`}
        data-index={i}
        aria-label={`Go to slide ${i + 1}`}
      />
    ))}
  </div>
</div>

<style>
  .carousel {
    position: relative;
    width: 100%;
    max-width: 600px;
    margin: 0 auto 3rem;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: var(--shadow-medium);
  }

  .carousel-track {
    position: relative;
    aspect-ratio: 4/3;
    background: var(--bg-paper);
  }

  .carousel-slide {
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 800ms ease-in-out;
  }

  .carousel-slide.active {
    opacity: 1;
  }

  .carousel-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-dots {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 0.5rem;
    z-index: 10;
  }

  .carousel-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    border: none;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 250ms ease;
    padding: 0;
  }

  .carousel-dot:hover {
    background: rgba(255, 255, 255, 0.8);
    transform: scale(1.2);
  }

  .carousel-dot.active {
    background: white;
    transform: scale(1.3);
  }

  @media (max-width: 720px) {
    .carousel {
      border-radius: 12px;
    }
  }
</style>

<script is:inline>
  document.addEventListener('DOMContentLoaded', function() {
    var slides = document.querySelectorAll('.carousel-slide');
    var dots = document.querySelectorAll('.carousel-dot');
    var currentIndex = 0;
    var intervalId;

    function showSlide(index) {
      // wrap around
      if (index >= slides.length) index = 0;
      if (index < 0) index = slides.length - 1;

      slides.forEach(function(slide) { slide.classList.remove('active'); });
      dots.forEach(function(dot) { dot.classList.remove('active'); });

      slides[index].classList.add('active');
      dots[index].classList.add('active');
      currentIndex = index;
    }

    function nextSlide() {
      showSlide(currentIndex + 1);
    }

    // auto-rotate every 5 seconds
    function startAutoRotate() {
      intervalId = setInterval(nextSlide, 5000);
    }

    // click dots to navigate
    dots.forEach(function(dot) {
      dot.addEventListener('click', function() {
        var index = parseInt(this.getAttribute('data-index'));
        showSlide(index);
        // reset timer on manual navigation
        clearInterval(intervalId);
        startAutoRotate();
      });
    });

    startAutoRotate();
  });
</script>
