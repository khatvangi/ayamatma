---
import BaseLayout from '../layouts/BaseLayout.astro';
import ImageCarousel from '../components/ImageCarousel.astro';
import RecentEssays from '../components/RecentEssays.astro';
import DailyVerse from '../components/DailyVerse.astro';
import { getCollection } from 'astro:content';

const lang = 'en';
const base = '';

// get essay stats
const allEssays = await getCollection('essays');
const englishEssays = allEssays.filter(e => e.id.endsWith('.en.mdx'));
const essayCount = englishEssays.length;

// get featured essays with their claims
const featuredSlugs = ['atman-not-soul', 'ananta-not-infinity', 'bhakti-jnana'];
const featuredEssays = englishEssays
  .filter(e => featuredSlugs.some(slug => e.id.includes(slug)))
  .map(e => ({
    slug: e.id.replace('.en.mdx', ''),
    title: e.data.title,
    claim: e.data.claim,
    readingTime: e.data.reading_time,
    tags: e.data.tags,
  }));
---

<BaseLayout
  title="Ayamatma"
  description="A quiet space where Vedanta, rigorous science, and clear thinking meet."
  lang={lang}
  showSplash={true}
>

  <section class="hero">
    <div class="hero-visual">
      <img src="/images/red-tree.png" alt="" class="hero-image" />
    </div>
    <h1 class="sutra">अयमात्मा ब्रह्म</h1>
    <p class="sutra-translit">Ayam Ātmā Brahma</p>
    <p class="tagline">A quiet space where Vedānta, rigorous science, and clear thinking meet.</p>
  </section>

  <section class="section">
    <p class="motto">A simple Vedānta notebook. No preaching. Only experiencing — <em>anubhava</em>.</p>
    <div class="prose">
      <p>
        This site springs from the mahāvākya Ayam Ātmā Brahma—this very Atman is Brahman. It operates on the conviction that clarity is devotion. Here, we explore Upaniṣadic Vedānta using the tools of science and philosophy: precise definitions, clear arguments, and honest dialogue. There are no competing knowledge systems. Truth is singular. All comes from the One.
      </p>
    </div>
  </section>

  <!-- start here + stats inline -->
  <section class="section">
    <div class="stats-grid">
      <div class="stat-item">
        <span class="stat-number">{essayCount} essays</span>
        <span class="stat-desc">in 3 languages</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">1600+ terms</span>
        <span class="stat-desc">Sanskrit dictionary</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">Daily verse</span>
        <span class="stat-desc">from the Gītā</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">Live vāda</span>
        <span class="stat-desc">audio discussions</span>
      </div>
    </div>
  </section>

  <!-- start here -->
  <section class="section">
    <a href={`${base}/essays/atman-not-soul`} class="start-here-card">
      <span class="start-here-badge">New here?</span>
      <h3 class="start-here-title">Start with "Ātman is Not Soul" →</h3>
      <p class="start-here-desc">Why Western translations miss what the Upaniṣads mean.</p>
    </a>
  </section>

  <section class="section">
    <h2 class="section-title">Explore</h2>
    <div class="paths">
      <a href={`${base}/primer`} class="path-link">
        <span class="path-name">Primer</span>
        <span class="path-desc">Core concepts: Ātman, Brahman, Māyā, Mokṣa</span>
      </a>
      <a href={`${base}/essays`} class="path-link">
        <span class="path-name">Essays</span>
        <span class="path-desc">{essayCount} deep-dives in English, हिंदी, తెలుగు</span>
      </a>
      <a href={`${base}/dictionary`} class="path-link">
        <span class="path-name">Dictionary</span>
        <span class="path-desc">1600+ Sanskrit terms with translations</span>
      </a>
      <a href={`${base}/vada`} class="path-link">
        <span class="path-name">Vāda</span>
        <span class="path-desc">Live audio rooms for philosophical dialogue</span>
      </a>
      <a href={`${base}/science`} class="path-link">
        <span class="path-name">Science & Vedānta</span>
        <span class="path-desc">Physics, chemistry, consciousness — Vedāntic lens</span>
      </a>
      <a href={`${base}/advaita`} class="path-link">
        <span class="path-name">Advaita</span>
        <span class="path-desc">Systematic non-dual philosophy</span>
      </a>
      <a href={`${base}/manifesto`} class="path-link">
        <span class="path-name">Protocols</span>
        <span class="path-desc">How we study with rigor</span>
      </a>
      <a href={`${base}/now`} class="path-link">
        <span class="path-name">Now</span>
        <span class="path-desc">What I'm currently working on</span>
      </a>
    </div>
  </section>

  <!-- featured essays -->
  <section class="section">
    <h2 class="section-title">Featured</h2>
    <div class="featured-essays">
      {featuredEssays.map(essay => (
        <a href={`${base}/essays/${essay.slug}`} class="featured-essay-card">
          <h3 class="featured-title">{essay.title}</h3>
          <p class="featured-claim">"{essay.claim}"</p>
          <div class="featured-meta">
            <span class="featured-time">{essay.readingTime} min</span>
            <span class="featured-langs">EN · हि · తె</span>
          </div>
        </a>
      ))}
    </div>
  </section>

  <section class="section">
    <DailyVerse lang={lang} />
  </section>

  <section class="section">
    <RecentEssays />
  </section>

  <section class="section">
    <h2 class="section-title">Glimpses</h2>
    <ImageCarousel />
  </section>

  <section class="section">
    <div class="quote-block">
      <p class="sanskrit">विद्या व्यये कृते वर्धते एव नित्यं।</p>
      <p class="english">Knowledge always grows when shared.</p>
    </div>
  </section>
</BaseLayout>

<style>
  /* start here - minimal, inline feel */
  .start-here-card {
    display: block;
    text-decoration: none;
    padding: 1rem 0;
    border-bottom: 1px solid var(--border);
  }

  .start-here-card:hover .start-here-title {
    color: var(--accent-warm);
  }

  .start-here-badge {
    font-size: 0.7rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--accent-warm);
  }

  .start-here-title {
    font-size: 1.1rem;
    font-weight: 500;
    color: var(--text);
    margin: 0.25rem 0;
    transition: color 200ms ease;
  }

  .start-here-desc {
    color: var(--muted);
    font-size: 0.9rem;
    line-height: 1.5;
    margin: 0;
  }

  .start-here-cta {
    display: none;
  }

  /* stats - horizontal flow, no boxes */
  .stats-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    justify-content: flex-start;
  }

  .stat-item {
    display: flex;
    align-items: baseline;
    gap: 0.5rem;
  }

  .stat-icon {
    font-size: 1rem;
  }

  .stat-number {
    font-size: 0.95rem;
    font-weight: 500;
    color: var(--text);
  }

  .stat-desc {
    font-size: 0.85rem;
    color: var(--muted);
  }

  .stat-desc::before {
    content: '— ';
    opacity: 0.5;
  }

  /* featured essays - cleaner cards */
  .featured-essays {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1rem;
  }

  .featured-essay-card {
    display: flex;
    flex-direction: column;
    padding: 1rem;
    text-decoration: none;
    border: 1px solid var(--border);
    border-radius: 8px;
    transition: border-color 200ms ease;
  }

  .featured-essay-card:hover {
    border-color: var(--accent-warm);
  }

  .featured-title {
    font-size: 0.95rem;
    font-weight: 500;
    color: var(--text);
    margin: 0 0 0.5rem 0;
    line-height: 1.4;
  }

  .featured-claim {
    font-size: 0.8rem;
    color: var(--muted);
    line-height: 1.5;
    font-style: italic;
    margin: 0;
    flex-grow: 1;
  }

  .featured-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.75rem;
    color: var(--muted);
    margin-top: 0.75rem;
    opacity: 0.7;
  }

  .featured-time {
    color: var(--muted);
  }

  /* responsive */
  @media (max-width: 600px) {
    .stats-grid {
      gap: 1rem 1.5rem;
    }

    .stat-desc {
      display: none;
    }

    .vada-actions {
      gap: 1rem;
    }

    .featured-essays {
      grid-template-columns: 1fr;
    }
  }
</style>
